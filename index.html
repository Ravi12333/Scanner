<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>iPhone Barcode Scanner</title>

<script src="https://unpkg.com/@zxing/library@latest"></script>

<style>
body {
    font-family: Arial, sans-serif;
    text-align: center;
    padding: 10px;
}
video {
    width: 100%;
    border: 2px solid black;
    border-radius: 8px;
}
table {
    width: 100%;
    margin-top: 15px;
    border-collapse: collapse;
}
th, td {
    border: 1px solid black;
    padding: 8px;
}
th {
    background: #eee;
}
</style>
</head>

<body>

<h3>Barcode Scanner</h3>
<video id="video" autoplay playsinline></video>

<table>
<thead>
<tr>
<th>#</th>
<th>Barcode</th>
<th>Format</th>
</tr>
</thead>
<tbody id="table"></tbody>
</table>

<script>
const codeReader = new ZXing.BrowserMultiFormatReader();
const video = document.getElementById("video");
const table = document.getElementById("table");

let count = 0;
let scanned = new Set();

codeReader
  .listVideoInputDevices()
  .then(devices => {
    const cameraId = devices[0].deviceId;
    codeReader.decodeFromVideoDevice(cameraId, video, (result, err) => {
      if (result) {
        if (!scanned.has(result.text)) {
          scanned.add(result.text);
          count++;
          table.innerHTML += `
            <tr>
              <td>${count}</td>
              <td>${result.text}</td>
              <td>${result.getBarcodeFormat()}</td>
            </tr>`;
        }
      }
    });
  })
  .catch(err => alert(err));
</script>

</body>
</html>
